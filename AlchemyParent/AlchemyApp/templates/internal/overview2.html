{% extends "internal/internal.html" %}

{% block body %}

<div id="wizard_container" class="py-8 flex flex-col items-center justify-center min-h-screen">
    
    <div id="org_info_box" class="overview_form min-w-100 md:w-192 bg-white p-10 rounded-lg shadow-lg mb-12">
        
        <div id="org_info_headers" class="text-center">
            <h1 class="text-2xl sm:text-4xl font-black tracking-wide text-blue-600 mb-2">Organization Information</h1>
            <h1 class="text-base sm:text-xl font-black tracking-wide text-blue-500 mb-8">Provide some general information about your organization.</h1>
        </div>

        <form id="org_info_form" action="#" method="post" class="space-y-8">
            {% csrf_token %}
            
            <div>
                <label for="{{org_form.client_name.id_for_label" class="block mb-1 font-semibold text-sm text-blue-700 opacity-70">Organization Name</label>
                <input type="text" name="{{org_form.client_name.name}}" id="{{org_form.client_name.auto_id}}" value="{{organization|default:org_form.client_name.value|default:''}}" placeholder="e.g., Acme Industries" required class="mt-1 w-full p-2.5 text-sm border-0 border-b-2 border-gray-200 text-gray-900 focus:ring-0 focus:border-blue-500 hover:border-blue-400 transition duration-200 {% if form.client_name.errors %}border-red-500{% endif %}">
                {% if org_form.client_name.errors %}
                    <span class="text-red-500 text-xs mt-1">
                        {{ org_form.client_name.errors.0 }}
                    </span>
                {% endif %}
            </div>
            
            <div>
                <div>
                    <label for="{{org_form.address1.id_for_label}}" class="block mb-1 font-semibold text-sm text-blue-700 opacity-70">Organization Address</label>
                    <input type="text" name="{{org_form.address1.name}}" id="{{org_form.address1.auto_id}}" value="{{ organization.address1|default:org_form.address1.value|default:'' }}" placeholder="Street Address" required class="mt-1 w-full p-2.5 text-sm border-0 border-b-2 border-gray-200 text-gray-900 focus:ring-0 focus:border-blue-500 hover:border-blue-400 transition duration-200 {% if form.address1.errors %}border-red-500{% endif %}">
                    {% if org_form.address1.errors %}
                        <span class="text-red-500 text-xs mt-1">
                            {{ org_form.address1.errors.0 }}
                        </span>
                    {% endif %}
                </div>
                <div class="flex mt-4">
                    <input type="text" name="{{org_form.address2.name}}" id="{{org_form.address2.auto_id}}" value="{{ organization.address2|default:org_form.address2.value|default:'' }}" placeholder="Unit/Suite Number" class="mr-6 w-1/2 p-2.5 text-sm border-0 border-b-2 border-gray-200 text-gray-900 focus:ring-0 focus:border-blue-500 hover:border-blue-400 transition duration-200 {% if form.address2.errors %}border-red-500{% endif %}">
                    {% if org_form.address2.errors %}
                        <span class="text-red-500 text-xs mt-1">
                            {{ org_form.address2.errors.0 }}
                        </span>
                    {% endif %}
                    <input type="text" name="{{org_form.city.name}}" id="{{org_form.city.auto_id}}" value="{{ organization.city|default:org_form.city.value|default:'' }}" placeholder="City" required class="w-1/2 p-2.5 text-sm border-0 border-b-2 border-gray-200 text-gray-900 focus:ring-0 focus:border-blue-500 hover:border-blue-400 transition duration-200 {% if form.city.errors %}border-red-500{% endif %}">
                    {% if org_form.city.errors %}
                        <span class="text-red-500 text-xs mt-1">
                            {{ org_form.city.errors.0 }}
                        </span>
                    {% endif %}
                </div>
                <div class="flex mt-4">
                    <div class="w-1/2 mr-6">
                        <select name="{{org_form.state.name}}" id="{{org_form.state.auto_id}}" class="mt-1 w-full p-2.5 text-sm border-0 border-b-2 border-gray-200 text-gray-900 focus:ring-0 focus:border-blue-500 hover:border-blue-400 transition duration-200{% if org_form.state.errors %}border-red-500{% endif %}">
                            <option value="">Select a state/territory</option>
                            {% for value, display_name in org_form.state.field.choices %}
                                <option value="{{ value }}" {% if organization.state|default:org_form.state.value == value %}selected{% endif %}>{{ display_name }}</option>
                            {% endfor %}
                        </select>
                        {% if org_form.state.errors %}
                            <span class="text-red-500 text-xs mt-1">
                                {{ org_form.state.errors.0 }}
                            </span>
                        {% endif %}
                    </div>

                    <div class="w-1/2">
                        <input type="text" name="{{org_form.zip_code.name}}" id="{{org_form.zip_code.auto_id}}" value="{{organization.zip_code|default:org_form.zip_code.value|default:''}}" placeholder="Zip Code" required class="mt-1 w-full p-2.5 text-sm border-0 border-b-2 border-gray-200 text-gray-900 focus:ring-0 focus:border-blue-500 hover:border-blue-400 transition duration-200 {% if form.zip_code.errors %}border-red-500 {% endif %}">
                        {% if org_form.zip_code.errors %}
                            <span class="text-red-500 text-xs mt-1">
                                {{ org_form.zip_code.errors.0 }}
                            </span>
                        {% endif %}
                    </div>
                </div>
            </div>
            
        </form>

    </div>

    <div id="system_info_box" class="overview_form w-5/6 min-w-100 md:w-192 bg-white p-10 rounded-lg shadow-lg ">
        
        <div id="system_info_box" class="text-center">
            <h1 class="text-4xl font-black tracking-wide text-blue-600 mb-2 overflow-x-auto whitespace-nowrap">System Information</h1>
            <h1 class="text-base sm:text-xl font-black tracking-wide text-blue-500 mb-8">Next, provide some general information about the system you'd like Authorized.</h1>
        </div>

        <form id="system_info_form" action="" method="post" class="space-y-8">
            {% csrf_token %}
            <div>
                <label for="{{system_form.name.id_for_label}}" class="block mb-1 font-semibold text-sm text-blue-700 opacity-70 whitespace-nowrap overflow-x-auto">Information System Name</label>
                <input type="text" name="{{system_form.name.name}}" id="{{system_form.name.auto_id}}" value=" {{system.name|default:''}} " placeholder="e.g., HR Management System" required class="mt-1 w-full p-2.5 text-sm border-0 border-b-2 border-gray-200 text-gray-900 focus:ring-0 focus:border-blue-500 hover:border-blue-400 transition duration-200 {% if form.system_name.errors %}border-red-500{% endif %}">
                {% if system_form.system_name.errors %}
                    <span class="text-red-500 text-xs mt-1">
                        {{ system_form.system_name.errors.0 }}
                    </span>
                {% endif %}
            </div>

            <div>
                <label for="{{system_form.owner_name.id_for_label}}" class="block mb-1 font-semibold text-sm text-blue-700 opacity-70 whitespace-nowrap overflow-x-auto">Information System Owner</label>
                <div class="flex mt-1">
                    <input type="text" name="{{system_form.owner_name.name}}" id="{{system_form.owner_name.auto_id}}" value="{{system.owner_name|default:''}}" placeholder="Name" required class="mr-6 w-1/2 p-2.5 text-sm border-0 border-b-2 border-gray-200 text-gray-900 focus:ring-0 focus:border-blue-500 hover:border-blue-400 transition duration-200 {% if form.owner_name.errors %}border-red-500{% endif %}">
                    {% if system_form.owner_name.errors %}
                        <span class="text-red-500 text-xs mt-1">
                            {{ system_form.owner_name.errors.0 }}
                        </span>
                    {% endif %}
                    <input type="text" name="{{system_form.owner_title.name}}" id="{{system_form.owner_title.auto_id}}" value="{{system.owner_title|default:''}}" placeholder="Role Title" required class="w-1/2 p-2.5 text-sm border-0 border-b-2 border-gray-200 text-gray-900 focus:ring-0 focus:border-blue-500 hover:border-blue-400 transition duration-200 {% if form.owner_title.errors %}border-red-500{% endif %}">
                    {% if system_form.owner_title.errors %}
                        <span class="text-red-500 text-xs mt-1">
                            {{ system_form.owner_title.errors.0 }}
                        </span>
                    {% endif %}
                </div>
                
                <div class="flex mt-4">
                    <input type="text" name="{{system_form.owner_phone_number.name}}" id="{{system_form.owner_phone_number.auto_id}}" value=" {{system.owner_phone_number|default:''}} " placeholder="Phone Number" required class="mr-6 w-1/2 p-2.5 text-sm border-0 border-b-2 border-gray-200 text-gray-900 focus:ring-0 focus:border-blue-500 hover:border-blue-400 transition duration-200 {% if form.owner_phone_number.errors %}border-red-500{% endif %}">

                {% if system_form.owner_number.errors %}
                    <span class="text-red-500 text-xs mt-1">
                        {{ system_form.owner_number.errors.0 }}
                    </span>
                {% endif %}
                <input type="text" name="{{system_form.owner_email.name}}" id="{{system_form.owner_email.auto_id}}" value="{{system.owner_email|default:''}}" placeholder="Email" required class="w-1/2 p-2.5 text-sm border-0 border-b-2 border-gray-200 text-gray-900 focus:ring-0 focus:border-blue-500 hover:border-blue-400 transition duration-200 {% if form.owner_email.errors %}border-red-500{% endif %}">
                {% if system_form.owner_email.errors %}
                    <span class="text-red-500 text-xs mt-1">
                        {{ system_form.owner_email.errors.0 }}
                    </span>
                {% endif %}
                </div>
            </div>

            <div class="w-full">
                <label for="{{system_form.description.id_for_label}}" class="block mb-2 font-semibold text-sm text-blue-700 opacity-70 whitespace-nowrap overflow-x-auto">What is the primary purpose/function of your system?</label>
                <textarea rows="4" name="{{system_form.description.name}}" id="{{system_form.description.auto_id}}" class="block p-2.5 w-full text-sm text-gray-900 bg-gray-50 rounded-lg border border-gray-300 focus:ring-blue-500 focus:border-blue-500 hover:border-blue-400 transition duration-200" placeholder="Write your answer here...">{{system.description|default:''}}</textarea> 
                {% if system_form.description.errors %}
                    <span class="text-red-500 text-xs mt-1">
                        {{ system_form.description.errors.0 }}
                    </span>
                {% endif %}
            </div>
        
        </form>

    </div>

    <button id ="scrollButton" class="fixed right-8 bottom-8 bg-blue-600 hover:bg-blue-700 text-white w-12 h-12 rounded-full flex items-center justify-center shadow-lg">
        <i id="scrollIcon" class="fas fa-chevron-down"></i>
    </button>
  
</div>
  
<!-- Javascript for interactive aspects of the onboarding wizard -->
<script type="text/javascript">

    // General selections
    const primaryFunctionModal = document.getElementById("primaryFunctionModal"); //Saving the modal in the primary function view in a variable for later use

    // Scrolling function for category selection view. When the circular scroll button in bottom right is clicked, it will either scroll down or up to show more of the categories
    document.getElementById("scrollButton").addEventListener("click", function() {
        const scrollButton = document.getElementById("scrollButton");
        const scrollIcon = document.getElementById("scrollIcon");

        // If the arrow is pointing down, it targets the new position which is one window-height down, and scrolls to it
        if (scrollIcon.classList.contains("fa-chevron-down")) {
            // Calculate the target scroll position, which is one viewport height from the current scroll position.
            const targetScrollPosition = window.pageYOffset + window.innerHeight;
            
            // Scroll to the target scroll position smoothly.
            window.scrollTo({
                top: targetScrollPosition,
                behavior: "smooth",
            });
        // Otherwise, it scrolls back to the top (implying the arrow is pointing up)
        } else {
            window.scrollTo({ top: 0, behavior: "smooth" });
        }
    })

    // Second scrolling function for category selection view. Responsible for changing the arrow in the icon to up and down depending on where the user is vertically. 
    window.addEventListener("scroll", () => {
        const scrollButton = document.getElementById("scrollButton");
        const scrollIcon = document.getElementById("scrollIcon");
        const scrollHeight = document.documentElement.scrollHeight;
        const clientHeight = document.documentElement.clientHeight;
        const scrollTop = document.documentElement.scrollTop;

        // When the user is near or at the bottom of the page, switches chevron to up, otherwise it will be pointing down
        if (scrollHeight - clientHeight - scrollTop < 5) {
            scrollIcon.classList.remove("fa-chevron-down");
            scrollIcon.classList.add("fa-chevron-up");
        } else {
            scrollIcon.classList.remove("fa-chevron-up");
            scrollIcon.classList.add("fa-chevron-down");
        }
    });

</script>

{% endblock %}